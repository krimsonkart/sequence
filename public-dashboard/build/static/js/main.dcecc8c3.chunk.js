(this["webpackJsonpsocket-io-client"]=this["webpackJsonpsocket-io-client"]||[]).push([[0],{118:function(e,t,n){},149:function(e,t,n){},151:function(e,t,n){"use strict";n.r(t);var c=n(14),a=n(0),r=n.n(a),s=n(10),o=n.n(s),i=n(26),u=(n(48),n(75)),j=n(76),l=n(85),d=n(84),b=n(81),O=n(7),h=n(44),m=n.n(h),p=n(77),f=n(5),g=(n(49),n(155)),x=n(156),y=n(157),v=n(160),S=function(){var e=Object(a.useState)(window.localStorage.getItem("userEmail")),t=Object(f.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(window.localStorage.getItem("userName")),s=Object(f.a)(r,2),o=s[0],i=s[1],u=Object(a.useState)(window.localStorage.getItem("userId")),j=Object(f.a)(u,2);return{userEmail:n,setUserEmail:c,userName:o,userId:j[0],setUserName:i,setUserId:j[1]}},C=n(78),w=n.n(C),N="LOGIN",I=function(e){return{type:N,payload:{user:e}}},E=n(1),A=Object(i.b)((function(e){return{user:e.user}}))((function(){var e=S(),t=e.userEmail,n=(e.setUserEmail,e.userName),c=e.setUserName,a=e.setUserId;return t?Object(E.jsx)("span",{children:n}):Object(E.jsx)(w.a,{clientId:"927228406323-fdhfbqgcto7opgu54u1h7qk3p6754iq8.apps.googleusercontent.com",buttonText:"Login",onSuccess:function(e){var t=e.profileObj.name;console.log("Logged in with google");var n=e.profileObj.email;a(n),c(t),window.localStorage.setItem("userEmail",n),window.localStorage.setItem("userName",t),window.localStorage.setItem("userId",n)},isSignedIn:!0,cookiePolicy:"single_host_origin"})})),T=function(){var e=Object(a.useState)([]),t=Object(f.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(!1),s=Object(f.a)(r,2),o=s[0],i=s[1],u=Object(a.useState)(""),j=Object(f.a)(u,2),l=j[0],d=j[1],b=S().userName;return Object(a.useEffect)((function(){function e(){return(e=Object(p.a)(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("/","api/sequence/games"));case 2:return t=e.sent,i(!0),e.next=6,t.json();case 6:n=e.sent,c(n.data);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!o&&function(){e.apply(this,arguments)}()})),b?Object(E.jsxs)(g.a,{fluid:!0,children:[Object(E.jsx)(x.a,{style:{paddingLeft:0,paddingRight:0,paddingTop:10,paddingBottom:10},children:Object(E.jsx)(g.a,{children:Object(E.jsxs)(x.a,{children:[Object(E.jsx)(y.a,{children:Object(E.jsx)("input",{type:"text",placeholder:"Room",value:l,onChange:function(e){d(e.target.value)}})}),Object(E.jsx)(y.a,{children:Object(E.jsx)(v.a,{href:"/ui/sequence/game/".concat(l),children:"Join Game"})}),Object(E.jsx)(y.a,{children:Object(E.jsx)(v.a,{href:"/ui/sequence/create",children:"Create"})})]})})}),Object(E.jsx)(x.a,{children:Object(E.jsx)(g.a,{children:n.map((function(e){return Object(E.jsxs)(x.a,{style:{paddingLeft:0,paddingRight:0,paddingTop:10,paddingBottom:10},children:[Object(E.jsx)(y.a,{children:e.id}),Object(E.jsx)(y.a,{children:Object(E.jsx)(v.a,{href:"/ui/sequence/game/".concat(e.id),children:"Join Game"})})]})}))})})]}):Object(E.jsx)(A,{})},k=(n(79),function(){var e=S(),t=e.userName,n=e.userId,c=Object(a.useState)(""),r=Object(f.a)(c,2),s=r[0],o=r[1],i=Object(a.useState)("2"),u=Object(f.a)(i,2),j=u[0],l=u[1],d=Object(a.useState)("2"),b=Object(f.a)(d,2),h=b[0],m=b[1],p=Object(O.f)();return t?Object(E.jsxs)(g.a,{children:[Object(E.jsxs)(x.a,{children:[Object(E.jsx)(y.a,{children:Object(E.jsx)("label",{children:"Name"})}),Object(E.jsx)(y.a,{children:Object(E.jsx)("input",{type:"text",placeholder:"Name",value:s,onChange:function(e){o(e.target.value)}})})]}),Object(E.jsxs)(x.a,{children:[Object(E.jsx)(y.a,{children:Object(E.jsx)("label",{children:"Number of players"})}),Object(E.jsx)(y.a,{children:Object(E.jsx)("input",{type:"text",placeholder:"Players",value:j,onChange:function(e){l(e.target.value)}})})]}),Object(E.jsxs)(x.a,{children:[Object(E.jsx)(y.a,{children:Object(E.jsx)("label",{children:"Number of Teams"})}),Object(E.jsx)(y.a,{children:Object(E.jsx)("input",{type:"text",placeholder:"Teams",value:h,onChange:function(e){m(e.target.value)}})})]}),Object(E.jsx)(x.a,{children:Object(E.jsx)(v.a,{onClick:function(){var e={name:s,numPlayers:j,numTeams:h,adminUser:n};fetch("".concat("/","api/sequence/game"),{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({game:e})}).then((function(e){return e.json()})).then((function(e){return p.push("/ui/sequence/game/".concat(e.gameId))}))},children:"Create Game"})})]}):Object(E.jsx)(A,{})}),R=n(27),B=(n(118),n(36)),P=n.n(B),_={NEW_GAME:"gameCreated",PLAY_CONFIRM:"playConfirm",START_GAME:"start",PLAYER_INACTIVE:"playerInactive",LOGGED_IN:"userLoggedIn",CHAT_MESSAGE:"newChatMessage",BROADCAST_PLAYER_JOINED:"playerJoined",BROADCAST_PLAYER_REJOINED:"playerRejoined",BROADCAST_PLAYER_DROPPED:"playerDropped",BROADCAST_PLACE_COIN:"placeCoin",BROADCAST_REMOVE_COIN:"removeCoin",BROADCAST_REPLACE_CARD:"replaceCard"},D=function(){var e=window.localStorage.getItem("userEmail");window.localStorage.getItem("userId"),window.localStorage.getItem("userName");var t=Object(a.useState)([]),n=Object(f.a)(t,2),r=n[0],s=n[1],o=Object(a.useRef)();Object(a.useEffect)((function(){return o.current=P()("/",{query:{playerId:e}}),Object.values(_).forEach((function(e){o.current.on(e,(function(t){var n={body:JSON.stringify({msg:e,body:JSON.stringify(t)}),ownedByCurrentUser:!1};s((function(e){return[].concat(Object(R.a)(e),[n])}))}))})),o.current.on("newChatMessage",(function(e){var t=Object(c.a)(Object(c.a)({},e),{},{ownedByCurrentUser:e.senderId===o.current.id});s((function(e){return[].concat(Object(R.a)(e),[t])}))})),o.current.on("error",(function(e){var t={body:JSON.stringify(e),ownedByCurrentUser:!0};s((function(e){return[].concat(Object(R.a)(e),[t])}))})),function(){o.current.disconnect()}}),[]);return{messages:r,setMessages:s,sendMessage:function(e){var t=e.indexOf(" ");o.current.emit(e.substr(0,t),JSON.parse(e.substr(t+1)))}}},J=function(e){var t=D(),n=t.messages,c=t.setMessages,a=t.sendMessage,s=r.a.useState(""),o=Object(f.a)(s,2),i=o[0],u=o[1];return Object(E.jsxs)("div",{className:"chat-room-container",children:[Object(E.jsx)("h1",{className:"room-name",children:"Room"}),Object(E.jsx)("div",{className:"messages-container",children:Object(E.jsx)("ol",{className:"messages-list",children:n.map((function(e,t){return Object(E.jsx)("li",{className:"message-item ".concat(e.ownedByCurrentUser?"my-message":"received-message"),children:e.body},t)}))})}),Object(E.jsx)("textarea",{value:i,onChange:function(e){u(e.target.value)},placeholder:"Write message...",className:"new-message-input-field"}),Object(E.jsx)("button",{onClick:function(){a(i);var e={body:i,ownedByCurrentUser:!0};c((function(t){return[].concat(Object(R.a)(t),[e])})),u("")},className:"send-message-button",children:"Send"})]})},L=n(21),q=n.n(L),G=n(159),M=n(161),U=n(158),H=n(22),F=(n(149),"playConfirm"),Y="player_reconnected",W="start",V="playerInactive",K="playerJoined",Q="playerRejoined",z="coinAction";var X=function(e,t,n){var c=window.localStorage.getItem("userEmail"),r=window.localStorage.getItem("userName"),s=Object(H.d)(),o=function(){for(var e=[],t=0;t<10;t++)e[t]=[];var n=["S","D","C","H"],c=["2","3","4","5","6","7","8","9","0","Q","K","A"],a={S:c,D:c,C:[].concat(c).reverse(),H:[].concat(c).reverse()},r=0,s=0,o=0,i=1,u=0,j=0;q.a.set(e,[0,0],"*"),q.a.set(e,[9,9],"*"),q.a.set(e,[0,9],"*"),q.a.set(e,[9,0],"*");for(var l=0;l<100;l++){if(!e[o][i]){var d=n[r],b=a[d][s];11===s&&(r=(r+1)%4),s=(s+1)%12,q.a.set(e,[o,i],"".concat(b).concat(d))}switch(u){case 0:i===9-j?(o++,u++):i++;break;case 1:o===9-j?(u++,i--):o++;break;case 2:i===j?(o--,u++,j++):i--;break;case 3:o===j?(i++,u=0):o--}}return e}(),i=Object(a.useState)(-1),u=Object(f.a)(i,2),j=u[0],l=u[1],d=Object(a.useState)(0),b=Object(f.a)(d,2),O=b[0],h=b[1],m=Object(a.useState)("created"),p=Object(f.a)(m,2),g=p[0],x=p[1],y=Object(a.useState)([]),v=Object(f.a)(y,2),S=v[0],C=v[1],w=Object(a.useState)([]),N=Object(f.a)(w,2),I=N[0],E=N[1],A=Object(a.useState)(0),T=Object(f.a)(A,2),k=T[0],R=T[1],B=Object(a.useState)(0),_=Object(f.a)(B,2),D=_[0],J=_[1],L=Object(a.useState)([]),G=Object(f.a)(L,2),M=G[0],U=G[1],X=Object(a.useState)([]),Z=Object(f.a)(X,2),$=Z[0],ee=Z[1],te=Object(a.useState)([]),ne=Object(f.a)(te,2),ce=ne[0],ae=ne[1],re=Object(a.useState)(!1),se=Object(f.a)(re,2),oe=se[0],ie=se[1],ue=Object(a.useRef)();function je(e){void 0!==e.winner&&t(!0),C({globalBoard:o,board:e})}function le(e){var t=e.hand;e.turn;E(t)}function de(e){U(e);var t=e.findIndex((function(e){return e.playerId===c}));-1!==t&&l(t)}function be(e){var t=e.players,n=e.history,c=e.turn;void 0!==c&&h(c),ee(n),de(t)}function Oe(e){var t=e.turn,n=e.history,c=e.board;h(t),je(c),ee(n)}function he(e){var t=e.board,n=e.hand,c=e.players,a=(e.history,e.turn);je(t),E(n),h(a),de(c)}function me(){console.log("Creating socket"),ue.current?console.log("Socket already created"):(ue.current=P()("/",{query:{playerId:c,gameId:e,userName:r}}),ue.current.on(W,he),ue.current.on(Y,he),ue.current.on(F,le),ue.current.on(z,Oe),ue.current.on(K,be),ue.current.on(Q,be),ue.current.on(V,be),ue.current.on("error",(function(e){var t=e.err;console.log("Error: ".concat(t)),s.show(t)})))}Object(a.useEffect)((function(){return fetch("".concat("/","api/sequence/game/").concat(e)).then((function(e){return e.json()})).then((function(e){h(O),x(e.state),de(e.players),R(e.numPlayers),J(e.numTeams),je(e.board),(j<0||"created"===e.state)&&n(!0),ie(!0);var t=!1;e.players.find((function(e){return e.playerId===c}))&&(t=!0),t&&me()})),function(){ue&&ue.current.disconnect()}}),[e]);return{board:S,gameState:g,hand:I,setHand:E,players:M,errors:ce,setErrors:function(e){ae(e),setTimeout((function(){ae((ce||[]).filter((function(e){var t=e.time;return Date.now()-t<3e3})))}),3e3)},gameLoaded:oe,history:$,turn:O,position:j,placeAction:function(e,t){ue.current.emit("play",{card:e,position:t})},replaceCard:function(e){ue.current.emit("play",{card:e,action:"replace"})},joinGame:function(t){ue.current||me(),ue.current.emit("join",{position:t,gameId:e,playerId:c})},startGame:function(){ue.current.emit("start",{gameId:e})},numTeams:D,numPlayers:k}},Z={0:"red.png",1:"green.png",2:"blue.png"};function $(e){var t="".concat(e,".png");return"AD.png"===t&&(t="aceDiamonds.png"),"*.png"===t&&(t="back2x.png"),t}var ee=["JS","JH"],te=["JD","JC"];var ne=function(e){var t=S().userName,n=Object(H.d)(),c=r.a.useState(!1),a=Object(f.a)(c,2),s=a[0],o=a[1],i=r.a.useState(""),u=Object(f.a)(i,2),j=u[0],l=u[1],d=r.a.useState(""),b=Object(f.a)(d,2),O=b[0],h=b[1],m=r.a.useState(!1),p=Object(f.a)(m,2),C=p[0],w=p[1],N=r.a.useState(!1),I=Object(f.a)(N,2),T=I[0],k=I[1],R=e.match.params.gameId,B=X(R,o,k),P=B.board,_=B.gameLoaded,D=B.hand,J=B.setHand,L=B.players,F=B.position,Y=(B.history,B.startGame),W=B.joinGame,V=B.turn,K=B.placeAction,Q=B.numTeams,z=B.numPlayers,ne=B.gameState,ce=B.replaceCard;var ae=function(e,t,c){if("inProgress"===ne){if(F!==V)return console.log("Not your turn"),void n.show("Not your turn");if(!j)return console.log("No Card Selected"),void n.show("No Card Selected");if(a=j,!ee.includes(a)&&!function(e){return te.includes(e)}(j)&&j!==c)return console.log("Not the selected card"),void n.show("Not the selected card");var a;K(j,"".concat(e,"-").concat(t)),l(null)}else n.show("Game not started")};function re(e){return O===e}function se(){w(!1)}function oe(){ce(j),w(!1)}return Object(E.jsx)(g.a,{children:Object(E.jsx)(x.a,{children:t?_?Object(E.jsxs)(g.a,{children:[Object(E.jsxs)(G.a,{show:s,children:[Object(E.jsx)(G.a.Header,{children:"Game over"}),Object(E.jsxs)(G.a.Body,{children:["Team ",q.a.get(P,"board.winner")," won"]})]}),Object(E.jsxs)(G.a,{show:T,onHide:function(){return k(!1)},children:[Object(E.jsx)(G.a.Header,{closeButton:!0,children:Object(E.jsx)(G.a.Title,{children:"Players"})}),Object(E.jsx)(G.a.Body,{children:Object(E.jsxs)(g.a,{children:[Object(E.jsxs)(x.a,{children:[Object(E.jsx)(y.a,{children:"Position"}),Object(E.jsx)(y.a,{children:"Team Number"}),Object(E.jsx)(y.a,{children:"Name"})]}),q.a.keys(Array(z)).map((function(e,t){return Object(E.jsxs)(x.a,{children:[Object(E.jsx)(y.a,{children:t}),Object(E.jsx)(y.a,{children:t%Q}),Object(E.jsx)(y.a,{children:L[t]&&!L[t].inactive?Object(E.jsx)("span",{children:L[t].name}):F<0?Object(E.jsx)(v.a,{onClick:function(){return W(t)},children:"Join"}):Object(E.jsx)("span",{children:"Waiting..."})})]})})),"created"!==ne||L.find((function(e){return!e||e.inactive}))?"":Object(E.jsx)(x.a,{children:Object(E.jsx)(v.a,{onClick:function(){return Y()},children:"Start"})})]})})]}),Object(E.jsxs)(G.a,{show:C,onHide:se,children:[Object(E.jsx)(G.a.Header,{closeButton:!0,children:Object(E.jsx)(G.a.Title,{children:"Players"})}),Object(E.jsx)(G.a.Body,{children:Object(E.jsx)(g.a,{children:Object(E.jsxs)(x.a,{children:[Object(E.jsx)(y.a,{children:Object(E.jsx)(v.a,{variant:"primary",onClick:oe,children:"yes"})}),Object(E.jsx)(y.a,{children:Object(E.jsx)(v.a,{variant:"secondary",onClick:se,children:"no"})})]})})})]}),Object(E.jsxs)(x.a,{children:[Object(E.jsx)(y.a,{children:Object(E.jsxs)("span",{children:["Turn: ",V]})}),Object(E.jsx)(y.a,{children:Object(E.jsxs)("span",{children:["Selected: ",j]})}),Object(E.jsx)(y.a,{children:Object(E.jsx)(v.a,{onClick:function(){return k(!0)},children:F<0?Object(E.jsx)("span",{children:"Join"}):Object(E.jsxs)("span",{children:["Position: ",F]})})})]}),Object(E.jsx)(x.a,{children:Object(E.jsx)(g.a,{fluid:!0,className:"container",children:(P.globalBoard||[]).map((function(e,t){return Object(E.jsx)(x.a,{children:e.map((function(e,n){var c=function(e,t,n){var c=e&&e.selectedPositions["".concat(t,"-").concat(n)];return void 0!==c&&"*"!==c&&"/img/coins/"+Z[c]}(P.board,t,n);return Object(E.jsx)(y.a,{children:Object(E.jsxs)(M.a,{onClick:function(){return ae(t,n,e)},children:[Object(E.jsx)(M.a.Img,{alt:"Card","img-border-primary":!0,src:"https://evening-lowlands-19146.herokuapp.com/img/".concat($(e))}),c&&Object(E.jsx)("img",{src:c,className:"coin img-responsive"})]})})}))},"row".concat(t))}))})}),Object(E.jsx)(x.a,{children:Object(E.jsx)(g.a,{fluid:!0,children:Object(E.jsx)(x.a,{style:{justifyContent:"center",padding:"20px"},children:(D||[]).map((function(e,t){return Object(E.jsx)(y.a,{children:Object(E.jsx)("img",{alt:"Card1",height:"100vh",src:"https://evening-lowlands-19146.herokuapp.com/img/".concat($(e)),className:re(t)?"border border-primary":"",onClick:function(){return function(e,t){l(e),h(t),P.board.selectedByIndex[e]>1&&w(!0),J(D)}(e,t)}})})}))})})})]}):Object(E.jsx)(U.a,{animation:"border",role:"status",children:Object(E.jsx)("span",{className:"sr-only",children:"Loading..."})}):Object(E.jsx)(A,{})})})},ce=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(j.a)(n,[{key:"componentDidMount",value:function(){var e=function(e){if(e)return JSON.parse(window.localStorage.getItem(e))}("user");e&&this.props.dispatch(I(e))}},{key:"render",value:function(){return Object(E.jsx)(b.a,{children:Object(E.jsxs)(O.c,{children:[Object(E.jsx)(O.a,{exact:!0,path:"/",component:T}),Object(E.jsx)(O.a,{exact:!0,path:"/ui/sequencerooms",component:T}),Object(E.jsx)(O.a,{exact:!0,path:"/ui/sequence/game/:gameId",component:ne}),Object(E.jsx)(O.a,{exact:!0,path:"/ui/sequence/create",component:k}),Object(E.jsx)(O.a,{exact:!0,path:"/ui/chat",component:J})]})})}}]),n}(r.a.Component),ae=Object(i.b)((function(e){return{user:e.user}}))(ce),re=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,162)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),c(e),a(e),r(e),s(e)}))},se=n(82),oe=n(23),ie=n(83),ue={profile:{id:"",name:"",email:""}},je=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ue,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N:return console.log("login",t.payload.user),Object(c.a)(Object(c.a)({},e),{},{user:t.payload.user});default:return e}},le=Object(oe.c)({user:je}),de=function(){return Object(oe.e)(le,Object(oe.d)(Object(oe.a)(ie.a)))}(),be={position:H.b.BOTTOM_CENTER,timeout:5e3,offset:"30px",transition:H.c.SCALE},Oe=Object(E.jsx)(H.a,Object(c.a)(Object(c.a)({template:se.a},be),{},{children:Object(E.jsx)(r.a.StrictMode,{children:Object(E.jsx)(i.a,{store:de,children:Object(E.jsx)(ae,{})})})}));o.a.render(Oe,document.getElementById("root")),re()},48:function(e,t,n){},49:function(e,t,n){}},[[151,1,2]]]);
//# sourceMappingURL=main.dcecc8c3.chunk.js.map